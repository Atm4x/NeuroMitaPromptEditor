# DSL-конструктор промптов

Мини-язык (DSL) служит для сборки итогового текста промпта из набора
шаблонов, логических скриптов и переменных.  
Все правила применяются **до** передачи строки модель-LLM.

---

## 1. Типы файлов

| Расширение | Назначение                                  |
|------------|---------------------------------------------|
| `.txt`     | Текстовые шаблоны. Содержат статический текст, плейсхолдеры `[<…>]`, секции `[ #TAG ] … [ /TAG ]`. |
| `.script`  | Скрипты DSL. Описывают логику (условия, присваивания, выбор секций). Возвращают строку командой `RETURN`. |

---

## 2. Механизмы вставки

| Синтаксис                                          | Описание                                                                          |
|----------------------------------------------------|-----------------------------------------------------------------------------------|
| `[<path/file.txt>]`                                | Вставить содержимое файла.                                                        |
| `[<path/file.script>]`                             | Выполнить скрипт и вставить результат.                                            |
| `{{INSERT_NAME}}`                                  | Вставка («insert»). Значение назначается из Python `interpreter.set_insert()`.    |
| `[ #TAG ] … [ /TAG ]`                              | Секция внутри `.txt`. Может быть загружена отдельно.                              |
| `LOAD TAG FROM "file.txt"`                         | Команда скрипта: вставить указанную секцию без маркеров.                          |
| `LOAD "file.txt"`                                  | Команда скрипта: вставить файл целиком; маркеры секций будут удалены.             |
| Inline-LOAD в выражении<br>`SET msg = LOAD TAG FROM "f.txt" + "!"` | Позволяет использовать `LOAD … FROM …` внутри `SET`/`RETURN` как часть выражения. |

---

## 3. Команды DSL (в `.script`)
